--- init.c.orig
+++ init.c
@@ -46,6 +46,7 @@
 #include <unistd.h>
 #include <string.h>
 #include <sys/utsname.h>
+#include <netdb.h>
 #include <errno.h>
 #include <sys/wait.h>
 
@@ -2770,6 +2771,31 @@
   return 0;
 }
 
+int getmailname(char *s, size_t l)
+{
+    FILE *f;
+    char tmp[512];
+    char *p = tmp;
+
+    if ((f = fopen ("/etc/mailname", "r")) == NULL)
+       return (-1);
+
+    if (fgets (tmp, 510, f) != NULL) {
+      while (*p && !ISSPACE(*p) && l > 0) {
+	*s++ = *p++;
+	l--;
+      }
+      if (*(s-1) == '.')
+	s--;
+      *s = 0;
+
+      fclose (f);
+      return 0;
+    }
+    fclose (f);
+    return (-1);
+}
+
 void mutt_init (int skip_sys_rc, LIST *commands)
 {
   struct passwd *pw;
@@ -2841,10 +2867,25 @@
     Hostname = mutt_substrdup (utsname.nodename, p);
     p++;
     strfcpy (buffer, p, sizeof (buffer)); /* save the domain for below */
+    Fqdn = safe_strdup (utsname.nodename);
   }
   else
     Hostname = safe_strdup (utsname.nodename);
 
+  /* if /etc/mailname exists use it and ignore everything else */
+  if (getmailname(buffer, sizeof (buffer)) != -1)
+      Fqdn = safe_strdup(buffer);
+
+  /* try gethostbyname(3) if /etc/mailname does not exists */
+  if (!Fqdn) {
+    struct hostent *hp;
+
+    if ((hp = gethostbyname(Hostname)))
+	Fqdn = safe_strdup(hp->h_name);
+  }
+
+  if (Fqdn) {
+  } else
 #ifndef DOMAIN
 #define DOMAIN buffer
   if (!p && getdnsdomainname (buffer, sizeof (buffer)) == -1)
